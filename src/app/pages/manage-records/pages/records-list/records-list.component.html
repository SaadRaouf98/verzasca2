<section class="records-list-container">
  <div class="row justify-content-between mb-1">
    <div class="col-12 col-lg-12 d-flex align-items-center">
      <p class="mb-0 d-flex align-items-center">
        <svg width="1.25rem" height="1.25rem">
          <use [attr.xlink:href]="'assets/icons/sprite.svg#nav-records'"></use>
        </svg>
        <span class="body-bold mx-2">
          {{
            viewMode == 'allRecords'
              ? ('shared.allRecords' | translate)
              : ('shared.activeRecords' | translate)
          }}</span
        >
      </p>
    </div>
  </div>

  <div class="filters-container">
    <mat-tab-group
      animationDuration="400ms"
      class="autoWidth"
      [selectedIndex]="activeTab"
      (selectedTabChange)="onTabClicked($event)"
    >
      <mat-tab
        label="{{
          'ManageRecordsModule.RecordsListComponent.financialCommitteeRecords' | translate
        }}"
      ></mat-tab>
      <mat-tab
        label=" {{
          'ManageRecordsModule.RecordsListComponent.preparatoryCommitteeRecords' | translate
        }}"
      ></mat-tab>
    </mat-tab-group>
  </div>
  <div class="content_wrapper mt-3">
    <!-- Filters -->
    <div class="row">
      <div class="col-md-10 col-12">
        <app-filters
          #filtersComponent
          class="w-100"
          [hasFiltersApplied]="isTableFiltered"
          [prioritiesList]="prioritiesList"
          (openDialog)="onOpenSearch($event)"
          (filtersChange)="onFiltersChange($event)"
        ></app-filters>
      </div>

      <div class="col-md-2 col-12" *ngIf="viewMode == 'allRecords'">
        <div class="d-flex h-100 align-items-center justify-content-end">
          <span
            class="body-bold text-small blue-text cursor-pointer d-flex align-items-center"
            (click)="expand()"
          >
            <svg width="1.25rem" height="1.25rem" class="mx-2">
              <use [attr.xlink:href]="'assets/icons/sprite.svg#show-signs'"></use>
            </svg>
            {{
              tableListComponent?.allRowsExpanded
                ? ('shared.hideSigns' | translate)
                : ('shared.showSigns' | translate)
            }}
          </span>
        </div>
      </div>
    </div>

    <!-- End Filters -->
    <div *ngIf="viewMode == 'activeRecords'">
      <div class="row mt-3" style="margin: 0 -0.35rem">
        <div
          class="col-xxl-4 col-xl-6 col-md-6 col-12 col-12 mb-2"
          style="padding: 0 0.35rem"
          *ngFor="let element of recordsSource"
        >
          <div class="record-card" (click)="onViewRecordDetails(element)">
            <div class="d-flex align-items-center justify-content-between py-1">
              <div class="d-flex align-items-center">
                <svg width="1rem" height="1rem" class="ms-2">
                  <use [attr.xlink:href]="'assets/icons/sprite.svg#pdf-small'"></use>
                </svg>
                <span
                  class="body-bold text-small"
                  [matTooltip]="element.title.length > 70 ? element.title : null"
                >
                  {{ element.title | truncate : 70 }}</span
                >
              </div>
              <span class="hover-eff btn p-2">
                <svg
                  width="1rem"
                  height="1rem"
                  class="cursor-pointer"
                  *ngIf="!element.isRestricted"
                  matTooltip="{{ 'shared.viewDetails' | translate }}"
                >
                  <use [attr.xlink:href]="'assets/icons/sprite.svg#view'"></use>
                </svg>
              </span>
            </div>
            <hr class="my-2" />
            <div class="row py-1">
              <div class="col-12 col-md-6 d-flex">
                <span class="body gray-500 text-small">
                  {{ 'ManageRecordsModule.RecordsListComponent.recordNumber' | translate }}
                </span>
                <span class="body gray-500 text-small mx-1"> : </span>
                <span class="body-bold text-small">
                  {{ element.exportNumber || '-' }}
                </span>
              </div>
              <div class="col-12 col-md-6 d-flex">
                <span class="body gray-500 text-small">{{ 'shared.processType' | translate }}</span>
                <span class="body gray-500 text-small mx-1"> : </span>
                <span class="body-bold text-small">
                  {{ element?.committee?.committeeSymbol || '-' }}
                </span>
              </div>
            </div>
            <hr class="my-2" />
            <div class="d-flex align-items-center mb-2">
              <svg width="20" height="20" class="ms-2 text-black">
                <use
                  width="20"
                  height="20"
                  [attr.xlink:href]="'assets/icons/sprite.svg#show-signs-black'"
                ></use>
              </svg>
              <span class="body-bold text-small">
                {{ 'shared.signs' | translate }}
              </span>
            </div>
            <ng-container *ngFor="let member of element?.members; let last = last">
              <div class="row d-flex align-items-center">
                <div class="col-md-6 col-12">
                  <span class="body text-small" [matTooltip]="member?.name">{{
                    member?.name | truncate : 40
                  }}</span>
                </div>
                <div class="col-md-6 col-12">
                  <div class="actionItem" *ngIf="member?.action === null" style="color: #9e9e9e">
                    <img src="assets/icons/NoOpinionYet.svg" />
                    <span> {{ 'shared.NoOpinionYet' | translate }}</span>
                  </div>
                  <div
                    class="actionItem"
                    style="color: #4caf50"
                    *ngIf="member?.action?.type === ExportableDocumentActionType.Sign"
                  >
                    <img src="assets/icons/Sign.svg" alt="sign icon" />
                    <span> {{ 'shared.isSigned' | translate }}</span>
                  </div>
                  <div
                    class="actionItem"
                    *ngIf="member?.action?.type === ExportableDocumentActionType.Conservatism"
                    style="color: #f76b15"
                  >
                    <img src="assets/icons/Conservatism.svg" alt="conservatism icon" />
                    <span>
                      {{
                        'ManageRecordsModule.RecordsListComponent.conservation' | translate
                      }}</span
                    >
                  </div>
                  <div
                    class="actionItem"
                    *ngIf="member?.action?.type === ExportableDocumentActionType.OpinionRefrain"
                    style="color: #d32f2f"
                  >
                    <img src="assets/icons/OpinionRefrain.svg" alt="opinion refrain icon" />
                    <span> {{ 'shared.OpinionRefrain' | translate }}</span>
                  </div>
                </div>
              </div>
              <hr class="line mt-2" *ngIf="!last" />
            </ng-container>
          </div>
        </div>
      </div>
    </div>

    <app-table-list
      #tableList
      *ngIf="viewMode == 'allRecords'"
      [className]="'primary-table'"
      [columnsConfig]="columnsConfig"
      [columns]="columns"
      [isLoading]="isLoadingTable"
      [rows]="recordsSource"
      (filterChanged)="onFiltersChange($event)"
      [resetTableFilters]="!isTableFiltered"
      [hasPaginator]="true"
      [pageIndex]="pageIndex"
      [pageSize]="pageSize"
      [totalElements]="length"
      (pageChange)="onPaginationChange($event)"
      class="new-primary-table mt-3"
    >
    </app-table-list>
  </div>
</section>
