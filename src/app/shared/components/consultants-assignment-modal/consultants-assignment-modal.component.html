<div class="d-flex justify-content-between mb-3 custom-modal-header">
  <div>
    <p class="body-bold mb-2">
      {{
        'SharedModule.ConsultantsAssignmentModalComponent.assignmentSelectConsultant' | translate
      }}
    </p>
    <p class="body text-small gray-700 mb-0">
      {{ 'SharedModule.ConsultantsAssignmentModalComponent.selectConsultant' | translate }}
    </p>
  </div>

  <svg width="1.25rem" height="1.25rem" class="cursor-pointer" (click)="onCancel()">
    <use [attr.xlink:href]="'assets/icons/sprite.svg#circle-close'"></use>
  </svg>
</div>

<div class="custom-modal-body" mat-dialog-contents>
  <form autocomplete="off" [formGroup]="form">
    <div class="row">
      <!-- consultantGroup -->
      <div class="col-12 mb-3">
        <p class="body mb-2">
          {{ 'SharedModule.ConsultantsAssignmentModalComponent.selectGroupConsultant' | translate }}
        </p>
        <app-select
          formControlName="consultantGroup"
          [options]="(consultanGroupsList$ | async)?.data"
          [bindLabel]="'title'"
          [bindValue]="'id'"
          [placeholder]="'shared.select' | translate"
          [multiple]="false"
          (searchChange)="searchOnConsultantGroups($event)"
          (selectionChange)="onSelectConsultantGroup()"
          [searchable]="false"
          [appendTo]="'body'"
        >
        </app-select>
      </div>
      <!-- End consultantGroup -->
      <!-- mainConsultant -->
      <div class="col-12 mb-3">
        <p class="body mb-2">
          {{ 'SharedModule.ConsultantsAssignmentModalComponent.selectMainConsultant' | translate }}
          <span class="text-danger text-small">*</span>
        </p>
        <app-select
          formControlName="mainConsultant"
          [options]="(usersList$ | async)?.data"
          [bindLabel]="'name'"
          [bindValue]="'id'"
          [placeholder]="'shared.select' | translate"
          [multiple]="false"
          [hideSelected]="true"
          (searchChange)="searchOnUsers($event)"
          (selectionChange)="onSelectionChange()"
          [searchable]="false"
          [appendTo]="'body'"
        >
        </app-select>
      </div>
      <!-- End mainConsultant -->
      <!-- coordinatingSubConsultants -->
      <div class="col-12 mb-3">
        <p class="body mb-2">
          {{ 'SharedModule.ConsultantsAssignmentModalComponent.selectSubConsultant' | translate }}
        </p>
        <app-select
          formControlName="coordinatingSubConsultants"
          [options]="(usersList$ | async)?.data"
          [bindLabel]="'name'"
          [bindValue]="'id'"
          [placeholder]="'shared.select' | translate"
          [multiple]="true"
          [searchable]="true"
          [showSelected]="false"
          [hideSelected]="true"
          [showSelected]="true"
          (searchChange)="searchOnUsers($event)"
          (selectionChange)="onSelectionChange()"
          [appendTo]="'body'"
        >
        </app-select>
      </div>
      <!-- End coordinatingSubConsultants -->

      <!-- participatingSubConsultants -->
      <div class="col-12 mb-3">
        <p class="body mb-2">
          {{ 'SharedModule.ConsultantsAssignmentModalComponent.selectVoteConsultant' | translate }}
        </p>
        <app-select
          formControlName="participatingSubConsultants"
          [options]="(usersList$ | async)?.data"
          [bindLabel]="'name'"
          [bindValue]="'id'"
          [placeholder]="'shared.select' | translate"
          [multiple]="true"
          [searchable]="true"
          [showSelected]="false"
          [hideSelected]="true"
          [showSelected]="true"
          (searchChange)="searchOnUsers($event)"
          (selectionChange)="onSelectionChange()"
          [appendTo]="'body'"
        >
        </app-select>
      </div>
      <!-- End participatingSubConsultants -->

      <!-- <div class="col-12 mat-form-field-div | consultants-div" [ngClass]="{
          'mat-form-field-div-error':
            form.get('consultants')?.errors && isTouched('consultants'),
          'mat-form-field-div-success':
            !form.get('consultants')?.errors && isTouched('consultants')
        }">
        <div class="label-container">
          <label for="consultants">
            {{ "shared.selectConsultants" | translate }}
          </label>
        </div>

        <ng-select formControlName="consultants" appInputSanitizer
          placeholder="{{ 'shared.selectConsultants' | translate }}" [bindLabel]="'name'" [compareWith]="compareFn"
          class="form-control" [multiple]="true" (search)="searchOnUsers($event)" (clear)="onClearConsultants()"
          (remove)="onRemoveSingleConsultant($event)">
          <ng-option *ngFor="let user of (usersList$ | async)?.data" [value]="user">
            {{ user.name }}
          </ng-option>
        </ng-select>

        <span class="span-error-message" *ngIf="
              form.get('consultants')?.errors?.['required'] &&
              isTouched('consultants')
            ">
          {{
          "SharedModule.ConsultantsAssignmentModalComponent.selectAtLeastOneConsultant"
          | translate
          }}
        </span>
      </div>

      <div *ngIf="selectedConsultants && selectedConsultants.length" class="col-12">
        <div class="label-container">
          <label for="consultants">
            {{
            "SharedModule.ConsultantsAssignmentModalComponent.selectMainConsulant"
            | translate
            }}
          </label>
        </div>

        <mat-radio-group formControlName="mainConsultantId" aria-label="Select main Consultant">
          <mat-radio-button *ngFor="let consultant of selectedConsultants" [value]="consultant.id">
            {{ consultant.name }}</mat-radio-button>
        </mat-radio-group>
      </div> -->
    </div>
  </form>
</div>

<div
  mat-dialog-actions
  class="d-flex justify-content-between align-items-center mt-4 custom-modal-footer"
>
  <button
    class="button button-primary button-lg"
    style="flex: 0 0 69%"
    (click)="onSubmit()"
    [disabled]="form.invalid || disableSubmitBtn"
  >
    {{ 'shared.approveBtn' | translate }}
  </button>
  <button class="button button-secondary button-lg" style="flex: 0 0 29%" (click)="onCancel()">
    {{ 'shared.cancel' | translate }}
  </button>
</div>
