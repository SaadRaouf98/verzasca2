<!-- منطقة الرفع -->
<div id="uploadArea" class="upload-area grid">
  <!-- العنوان -->
  <!-- <div class="upload-area__header">
    <p class="upload-area__paragraph">
      {{ desc }}
      <strong class="upload-area__tooltip">
        <span class="upload-area__tooltip-data">.{{ desc2 }}</span>
      </strong>
    </p>
  </div> -->

  <!-- منطقة الإسقاط -->
  <div class="row">
    <div [ngClass]="split ? 'col-12 col-md-6' : ''" class="">
      <div
        id="dropZoon"
        class="drop-zoon"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        (click)="onClickDropZone()"
        [class.drop-zoon--Uploaded]="fileUploaded"
        [ngStyle]="{ 'background-color': backgroundColor }"
      >
        <svg width="2.25rem" height="2.25rem" class="mb-3">
          <use [attr.xlink:href]="'assets/icons/sprite.svg#upload'"></use>
        </svg>
        <p class="body-bold primary-500">{{ 'attachment.select' | translate }}</p>
        <p class="body text-small gray-700">
          <span>{{ formattedAllowedExtensionsDisplay }}</span>
          {{ 'attachment.format' | translate }}
        </p>
        <button class="button button-secondary button-md custom-width">
          {{ 'attachment.upload' | translate }}
        </button>

        <input
          type="file"
          [id]="id"
          class="drop-zoon__file-input"
          [accept]="acceptedFileTypes"
          #file
          [multiple]="multiple"
          (change)="onFileSelected($event)"
          hidden
        />
      </div>
    </div>
    <div class="" [ngClass]="split ? 'col-12 col-md-6 ' : 'mt-3'">
      <ng-container *ngIf="values?.length > 0">
        <div class="d-flex flex-wrap gap-2 mt-3 w-100">
          <ng-container class="" *ngFor="let file of values; let i = index">
            <div class="d-flex align-items-center file-container w-100">
              <svg width="1.5rem" height="1.5rem" class="ms-3">
                <use [attr.xlink:href]="'assets/icons/sprite.svg#' + getFileIcon(file)"></use>
              </svg>
              <div class="w-100">
                <div class="d-flex justify-content-between align-items-center mb-2">
                  <span class="body-bold text-small" style="width: 90%; text-align: right">{{
                    file.name
                  }}</span>
                  <div class="d-flex align-items-center">
                    <svg
                      width="1.25rem"
                      height="1.25rem"
                      *ngIf="!loading"
                      class="cursor-pointer"
                      (click)="removeViewFile(file)"
                    >
                      <use [attr.xlink:href]="'assets/icons/sprite.svg#delete-sm'"></use>
                    </svg>
                  </div>
                </div>

                <div class="pl-3">
                  <!-- <mat-progress-bar mode="determinate" [value]="100"></mat-progress-bar> -->
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </ng-container>
      <!--      <h3 class="file-details__title mt-4">الملف المرفوع</h3>-->

      <ng-container *ngIf="uploadedFiles.length > 0">
        <!--      <h3 class="file-details__title mt-4">الملف المرفوع</h3>-->
        <div class="d-flex flex-wrap gap-2 w-100" (click)="$event.stopPropagation()">
          <ng-container class="" *ngFor="let file of uploadedFiles; let i = index">
            <div
              class="w-100 file-container"
              [class.mt-3]="i > 0"
              [ngStyle]="{ 'background-color': backgroundColor }"
            >
              <div class="d-flex align-items-center w-100">
                <svg width="1.5rem" height="1.5rem" class="ms-3">
                  <use
                    [attr.xlink:href]="'assets/icons/sprite.svg#' + getFileIcon(file.file)"
                  ></use>
                </svg>
                <div class="w-100">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="body-bold text-small" style="width: 90%; text-align: right">{{
                      file.file.name || file.file?.originalName
                    }}</span>
                    <div class="d-flex align-items-center">
                      <svg
                        *ngIf="showViewOption && !loading"
                        width="1rem"
                        height="1rem"
                        class="cursor-pointer mx-2"
                        (click)="onViewAttachment($event, file.file)"
                      >
                        <use [attr.xlink:href]="'assets/icons/sprite.svg#view'"></use>
                      </svg>
                      <svg
                        width="1.25rem"
                        height="1.25rem"
                        *ngIf="file.progress < 100"
                        class="cursor-pointer"
                        (click)="removeFile($event, file.id, i)"
                      >
                        <use [attr.xlink:href]="'assets/icons/sprite.svg#circle-close'"></use>
                      </svg>
                      <svg
                        width="1.25rem"
                        height="1.25rem"
                        *ngIf="file.progress == 100"
                        class="cursor-pointer"
                        (click)="removeFile($event, file.id, i)"
                      >
                        <use [attr.xlink:href]="'assets/icons/sprite.svg#delete-sm'"></use>
                      </svg>
                    </div>
                  </div>
                  <div
                    class="d-flex align-items-center"
                    [ngClass]="{ 'mb-3': file.progress < 100 || loading }"
                  >
                    <span class="body text-small gray-400" *ngIf="uploadFirst">
                      <ng-container *ngIf="file.progress < 100">
                        {{
                          (getFileSize(file.file) * file.progress) / 100 / 1024 | number : '1.0-0'
                        }}kb of {{ getFileSize(file.file) / 1024 | number : '1.0-0' }}kb
                      </ng-container>
                      <ng-container *ngIf="file.progress === 100">
                        {{ getFileSize(file.file) / 1024 | number : '1.0-0' }}kb of
                        {{ getFileSize(file.file) / 1024 | number : '1.0-0' }}kb
                      </ng-container>
                    </span>
                    <span class="mx-2" *ngIf="uploadFirst">-</span>
                    <span
                      *ngIf="file.progress < 100 && uploadFirst"
                      class="d-flex align-items-center"
                    >
                      <svg width="1rem" height="1rem" class="spin-icon">
                        <use [attr.xlink:href]="'assets/icons/sprite.svg#loading'"></use>
                      </svg>
                      <span class="body text-small mx-2">{{
                        'attachment.loading' | translate
                      }}</span>
                    </span>
                    <span
                      *ngIf="file.progress === 100 || !uploadFirst"
                      class="d-flex align-items-center"
                    >
                      <svg width="1rem" height="1rem" class="">
                        <use [attr.xlink:href]="'assets/icons/sprite.svg#loaded'"></use>
                      </svg>
                      <span class="body text-small mx-2">{{
                        'attachment.loaded' | translate
                      }}</span>
                    </span>
                  </div>
                </div>
              </div>
              <div class="pl-3" *ngIf="file.progress < 100">
                <!-- <mat-progress-bar mode="determinate" [value]="50"></mat-progress-bar> -->
                <mat-progress-bar mode="determinate" [value]="file.progress"></mat-progress-bar>
              </div>
            </div>
          </ng-container>
        </div>
        <button
          *ngIf="showBtn"
          class="button button-primary button-lg w-100 mt-4"
          [disabled]="loading"
          (click)="onUploadClicked()"
        >
          {{ 'attachment.uploadFiles' | translate }}
        </button>
      </ng-container>
    </div>
  </div>
</div>
